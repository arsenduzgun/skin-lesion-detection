services:
  backend:
    build:
      context: ./backend
    ports:
      - "5000:5000"

    # Bind mounts override baked files so you can edit without rebuilds
    volumes:
      - ./backend/app.py:/backend/app.py
      - ./backend/templates:/backend/templates
      - ./backend/static:/backend/static
      - ./backend/models:/backend/models:ro

    # Point app to the mounted model (same path as baked, so no env override needed)
    environment:
      MODEL_PATH: /backend/models/HAM10000_efficientnetB0.keras
      META_PATH: /backend/models/HAM10000_meta.json

    # Auto-reload Python code on change (templates/CSS update on refresh)

    command: >
      gunicorn --reload -w 2 -k gthread -t 120 -b 0.0.0.0:5000 app:app



    restart: "no"







# build and run: docker compose up --build -d

# server: localhost:5000

# kill: docker compose down