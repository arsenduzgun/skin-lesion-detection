services:
  web:
    build: .
    ports:
      - "5000:5000"

    # Bind mounts override baked files so you can edit without rebuilds
    volumes:
      - ./app.py:/app/app.py
      - ./templates:/app/templates
      - ./static:/app/static
      - ./model-dev/models:/app/model-dev/models:ro

    # Point app to the mounted model (same path as baked, so no env override needed)
    environment:
      MODEL_PATH: /app/model-dev/models/HAM10000_efficientnetB0.keras
      META_PATH: /app/model-dev/models/HAM10000_meta.json

    # Auto-reload Python code on change (templates/CSS update on refresh)

    command: >
      gunicorn --reload -w 2 -k gthread -t 120 -b 0.0.0.0:5000 app:app



    restart: "no"







# build and run: docker compose up --build -d

# kill: docker compose down